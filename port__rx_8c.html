<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Retina: recepción y transmisión de infrarrojos: port/nucleo_stm32f446re/src/port_rx.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Retina: recepción y transmisión de infrarrojos
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('port__rx_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">port_rx.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Portable functions to interact with the infrared receiver FSM library.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="port__rx_8h.html">port_rx.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="port__system_8h.html">port_system.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fsm__rx__nec_8h.html">fsm_rx_nec.h</a>&quot;</code><br />
<code>#include &lt;string.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structport__rx__hw__t.html">port_rx_hw_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure to define the HW dependencies of an infrared receiver.  <a href="structport__rx__hw__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adfc4d3d8a0fc4e918aca2a1b26888642"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__rx_8c.html#adfc4d3d8a0fc4e918aca2a1b26888642">_reset_edge_ticks_idx</a> (uint8_t rx_id)</td></tr>
<tr class="memdesc:adfc4d3d8a0fc4e918aca2a1b26888642"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the elements of the array of time ticks to '0' and init the index to '0' as well.  <a href="port__rx_8c.html#adfc4d3d8a0fc4e918aca2a1b26888642">More...</a><br /></td></tr>
<tr class="separator:adfc4d3d8a0fc4e918aca2a1b26888642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3fb0b453990403c94881a28727df47b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__rx_8c.html#ad3fb0b453990403c94881a28727df47b">_store_edge_tick</a> (uint8_t rx_id)</td></tr>
<tr class="memdesc:ad3fb0b453990403c94881a28727df47b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store the time tick of the last edge detected. This function is called by the ISR after an interruption of the GPIO.  <a href="port__rx_8c.html#ad3fb0b453990403c94881a28727df47b">More...</a><br /></td></tr>
<tr class="separator:ad3fb0b453990403c94881a28727df47b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada601d2748d08bea6f2e745dba307143"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__rx_8c.html#ada601d2748d08bea6f2e745dba307143">_timer_rx_setup</a> ()</td></tr>
<tr class="memdesc:ada601d2748d08bea6f2e745dba307143"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure the timer tick. This timer sets the basis for tick counting for checking received NEC symbols.  <a href="port__rx_8c.html#ada601d2748d08bea6f2e745dba307143">More...</a><br /></td></tr>
<tr class="separator:ada601d2748d08bea6f2e745dba307143"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ef09693179985ae45e7ff87831701cf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__rx_8c.html#a5ef09693179985ae45e7ff87831701cf">port_rx_init</a> (uint8_t rx_id)</td></tr>
<tr class="memdesc:a5ef09693179985ae45e7ff87831701cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure the HW specifications of a given infrared receiver.  <a href="port__rx_8c.html#a5ef09693179985ae45e7ff87831701cf">More...</a><br /></td></tr>
<tr class="separator:a5ef09693179985ae45e7ff87831701cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a184fe2d9bbb46a3c23162dcea0d85092"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__rx_8c.html#a184fe2d9bbb46a3c23162dcea0d85092">port_rx_en</a> (uint8_t rx_id, bool interr_en)</td></tr>
<tr class="memdesc:a184fe2d9bbb46a3c23162dcea0d85092"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable/disable the interruptions of the infrared receiver.  <a href="port__rx_8c.html#a184fe2d9bbb46a3c23162dcea0d85092">More...</a><br /></td></tr>
<tr class="separator:a184fe2d9bbb46a3c23162dcea0d85092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b075d6927a2417e0e8f77f07fd5d7f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__rx_8c.html#a8b075d6927a2417e0e8f77f07fd5d7f0">port_rx_tmr_start</a> ()</td></tr>
<tr class="memdesc:a8b075d6927a2417e0e8f77f07fd5d7f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable the tick count timer.  <a href="port__rx_8c.html#a8b075d6927a2417e0e8f77f07fd5d7f0">More...</a><br /></td></tr>
<tr class="separator:a8b075d6927a2417e0e8f77f07fd5d7f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a528b7d08de033a1a60b6a191dcaf6d92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__rx_8c.html#a528b7d08de033a1a60b6a191dcaf6d92">port_rx_tmr_stop</a> ()</td></tr>
<tr class="memdesc:a528b7d08de033a1a60b6a191dcaf6d92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable the tick count timer.  <a href="port__rx_8c.html#a528b7d08de033a1a60b6a191dcaf6d92">More...</a><br /></td></tr>
<tr class="separator:a528b7d08de033a1a60b6a191dcaf6d92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa84db03071cd8b41482846fbef7d92c0"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__rx_8c.html#aa84db03071cd8b41482846fbef7d92c0">port_rx_get_num_edges</a> (uint8_t rx_id)</td></tr>
<tr class="memdesc:aa84db03071cd8b41482846fbef7d92c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of edges detected by the infrared receiver so far.  <a href="port__rx_8c.html#aa84db03071cd8b41482846fbef7d92c0">More...</a><br /></td></tr>
<tr class="separator:aa84db03071cd8b41482846fbef7d92c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa467ec1901152155ceaaeb6862721b1"><td class="memItemLeft" align="right" valign="top">uint16_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__rx_8c.html#afa467ec1901152155ceaaeb6862721b1">port_rx_get_buffer_edges</a> (uint8_t rx_id)</td></tr>
<tr class="memdesc:afa467ec1901152155ceaaeb6862721b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a pointer to de memory address of the array that stores the time ticks of the edges detected by the infrared receiver.  <a href="port__rx_8c.html#afa467ec1901152155ceaaeb6862721b1">More...</a><br /></td></tr>
<tr class="separator:afa467ec1901152155ceaaeb6862721b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fe5eb9261a282e7e047640ed4b87490"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__rx_8c.html#a5fe5eb9261a282e7e047640ed4b87490">port_rx_clean_buffer</a> (uint8_t rx_id)</td></tr>
<tr class="memdesc:a5fe5eb9261a282e7e047640ed4b87490"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean the array that stores the time ticks of the edges detected by the infrared receiver.  <a href="port__rx_8c.html#a5fe5eb9261a282e7e047640ed4b87490">More...</a><br /></td></tr>
<tr class="separator:a5fe5eb9261a282e7e047640ed4b87490"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b2096b8b2643286dc3a7e5110e5ae85"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__rx_8c.html#a7b2096b8b2643286dc3a7e5110e5ae85">EXTI9_5_IRQHandler</a> (void)</td></tr>
<tr class="memdesc:a7b2096b8b2643286dc3a7e5110e5ae85"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function handles Px5-Px9 global interrupts.  <a href="port__rx_8c.html#a7b2096b8b2643286dc3a7e5110e5ae85">More...</a><br /></td></tr>
<tr class="separator:a7b2096b8b2643286dc3a7e5110e5ae85"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a333808f94789e3e5a0a9d158715bf651"><td class="memItemLeft" align="right" valign="top"><a id="a333808f94789e3e5a0a9d158715bf651"></a>
static <a class="el" href="structport__rx__hw__t.html">port_rx_hw_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="port__rx_8c.html#a333808f94789e3e5a0a9d158715bf651">receivers_arr</a> []</td></tr>
<tr class="memdesc:a333808f94789e3e5a0a9d158715bf651"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array of elements that represents the HW characteristics of the infrared receivers. <br /></td></tr>
<tr class="separator:a333808f94789e3e5a0a9d158715bf651"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Portable functions to interact with the infrared receiver FSM library. </p>
<dl class="section author"><dt>Author</dt><dd>Sistemas Digitales II </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2023-01-01 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="adfc4d3d8a0fc4e918aca2a1b26888642"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfc4d3d8a0fc4e918aca2a1b26888642">&#9670;&nbsp;</a></span>_reset_edge_ticks_idx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _reset_edge_ticks_idx </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>rx_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the elements of the array of time ticks to '0' and init the index to '0' as well. </p>
<blockquote class="doxtable">
<p>&#160;&#160;&#160;&#160;💡 To set all the elements of an array to one value, you can use function <code>memset</code>. You need a pointer to the array (its name), the value you want to set, and the length (in bytes) of the array (so you need to multiply the number of elements by the size of the type of the elements of the array). To use this function you need to include the &lt;string.h&gt; library. </p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rx_id</td><td>Receiver ID. This index is used to select the element of the <code>receivers_arr[]</code> array. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad3fb0b453990403c94881a28727df47b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3fb0b453990403c94881a28727df47b">&#9670;&nbsp;</a></span>_store_edge_tick()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void _store_edge_tick </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>rx_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Store the time tick of the last edge detected. This function is called by the ISR after an interruption of the GPIO. </p>
<blockquote class="doxtable">
<p><b>TO-DO alumnos:</b></p>
<p>✅ 1. (Optional) For convenience, retrieve the edge index into a local variable. <br  />
✅ 2. Call function <code><a class="el" href="port__system_8h.html#a67c2ddb6c83b821abe663b86bc76a08e" title="Read the digital value of a GPIO.">port_system_gpio_read()</a></code> and retrieve the value of the GPIO in order to identify if it was a rising or a falling edge. <br  />
✅ 3. For security reasons, <b>check if the value read is equal to the last bit of the edge index.</b> Otherwise, return. <br  />
&#160;&#160;&#160;&#160;💡 <em>The last bit of the edge index</em> is '0' when the index is even, and '1' when the index is odd. <br  />
&#160;&#160;&#160;&#160;💡 The GPIO connected to the infrared receiver is at high level when idle. Thus, <b>the first timestamp should be with a falling edge (the GPIO should be low), and the index '0' is even.</b> <br  />
&#160;&#160;&#160;&#160;💡 Consequently, <b>the next edge detected should be with a rising edge (the GPIO should be high), and the index '1' is even.</b> <br  />
&#160;&#160;&#160;&#160;💡 This sequence repeats constantly in the signal received. So, it is convenient to check that we are doing the things well. <br  />
✅ 4. If the index is lower than the size of the <code>edge_ticks</code> array: (i) store the value of the register <code>CNT</code> of the timer <code>TIM3</code>, and (ii) increase the edge index. Otherwise, return. <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rx_id</td><td>Receiver ID. This index is used to select the element of the <code>receivers_arr[]</code> array. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ada601d2748d08bea6f2e745dba307143"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada601d2748d08bea6f2e745dba307143">&#9670;&nbsp;</a></span>_timer_rx_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _timer_rx_setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure the timer tick. This timer sets the basis for tick counting for checking received NEC symbols. </p>
<p>This timer does not generate interruptions. It is like the Systick, but faster. The Systick has a period of 1 ms which is to large for the identification of NEC symbols. That is why we need another counter.</p>
<p>With this timer we are not interested very much on the value of the <code>ARR</code> register but on the <code>PSC</code> register. We will set up the <code>ARR</code> register to its maximum value to ensure that each increment of the prescaler corresponds to <a class="el" href="fsm__rx__nec_8h.html#ad49fb3e7b8b2467df81ad95b75ef2ab8">NEC_RX_TIMER_TICK_BASE_US</a>. On the other hand, we set the <code>PSC</code> so that each increment of this register represents <a class="el" href="fsm__rx__nec_8h.html#ad49fb3e7b8b2467df81ad95b75ef2ab8">NEC_RX_TIMER_TICK_BASE_US</a>.</p>
<blockquote class="doxtable">
<p><b>TO-DO alumnos:</b></p>
<p>✅ 1. Enable the clock source of our timer. <br  />
&#160;&#160;&#160;&#160;💡 The timer <code>TIM3</code> is connected to the bus <code>APB1</code>. So, we must use the <code>APB1ENR</code> register (field of <code>RCC</code>). You can check it looking at the Table 1 of the Reference Manual. <br  />
&#160;&#160;&#160;&#160;💡 You can use the macro <code>RCC_APB1ENR_TIM3EN</code>. <br  />
✅ 2. (Optional) Disable the counter (register <code>CR1</code>) and enable the autoreload preaload (register <code>ARPE</code>). <br  />
✅ 3. Reset the timer count (register <code>CNT</code>). <br  />
✅ 4. Set the value of the autoreload register (register <code>ARR</code>) to its maximum value. <br  />
✅ 5. Set the value of the prescaler (register <code>PSC</code>). <br  />
&#160;&#160;&#160;&#160;💡 To calculate its value use the equation: PSC = fclk * Tinterr - 1. Where <em>Tinterr</em> is the time of ticks defined by <a class="el" href="fsm__rx__nec_8h.html#ad49fb3e7b8b2467df81ad95b75ef2ab8">NEC_RX_TIMER_TICK_BASE_US</a> in seconds. <br  />
✅ 6. Generate an update event (register <code>EGR</code>). <br  />
</p>
</blockquote>

</div>
</div>
<a id="a7b2096b8b2643286dc3a7e5110e5ae85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b2096b8b2643286dc3a7e5110e5ae85">&#9670;&nbsp;</a></span>EXTI9_5_IRQHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EXTI9_5_IRQHandler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function handles Px5-Px9 global interrupts. </p>
<p>First, this function identifies the line/ pin which has raised the interruption. Then, perform the desired action. Before leaving it cleans the interrupt pending register.</p>
<blockquote class="doxtable">
<p><b>TO-DO alumnos</b></p>
<p>✅ 1. Clean the corresponding bit of the <code>PR</code> register. Use the <a class="el" href="port__rx_8h.html#afd9f3afa90aff70cfe1703193fa9e1fe">IR_RX_0_ID</a> index to get the port and pin from the <code>receivers_arr</code>. <br  />
&#160;&#160;&#160;&#160;💡 Recommendation: use the macro <a class="el" href="port__system_8h.html#ad8e7767483a0c8f878cab29ad46ec656">BIT_POS_TO_MASK</a> <br  />
&#160;&#160;&#160;&#160;💡 <b>To clean an interrupt in the <em>Pending Register</em> (<code>PR</code>) we must write '1' in the corresponding bit</b>. <em>Look at the example in section "3.9.7. Ejemplo de interrupción externa" of the reference book.</em> You can also find this out by consulting the <em>reference manual</em> (section "10.3.6 Pending register (EXTI_PR)") * <br  />
✅ 2. Call function <code><a class="el" href="port__rx_8c.html#ad3fb0b453990403c94881a28727df47b" title="Store the time tick of the last edge detected. This function is called by the ISR after an interrupti...">_store_edge_tick()</a></code> to store the time tick for the given infrared receiver. <br  />
</p>
</blockquote>

</div>
</div>
<a id="a5fe5eb9261a282e7e047640ed4b87490"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fe5eb9261a282e7e047640ed4b87490">&#9670;&nbsp;</a></span>port_rx_clean_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void port_rx_clean_buffer </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>rx_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean the array that stores the time ticks of the edges detected by the infrared receiver. </p>
<blockquote class="doxtable">
<p><b>TO-DO alumnos:</b></p>
<p>✅ 1. Call function <code><a class="el" href="port__rx_8c.html#adfc4d3d8a0fc4e918aca2a1b26888642" title="Set the elements of the array of time ticks to &#39;0&#39; and init the index to &#39;0&#39; as well.">_reset_edge_ticks_idx()</a></code>. <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rx_id</td><td>Receiver ID. This index is used to select the element of the <code>receivers_arr[]</code> array. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a184fe2d9bbb46a3c23162dcea0d85092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a184fe2d9bbb46a3c23162dcea0d85092">&#9670;&nbsp;</a></span>port_rx_en()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void port_rx_en </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>rx_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>interr_en</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable/disable the interruptions of the infrared receiver. </p>
<blockquote class="doxtable">
<p><b>TO-DO alumnos:</b></p>
<p>✅ 1. Call function <code><a class="el" href="port__rx_8c.html#adfc4d3d8a0fc4e918aca2a1b26888642" title="Set the elements of the array of time ticks to &#39;0&#39; and init the index to &#39;0&#39; as well.">_reset_edge_ticks_idx()</a></code> to init some internal variables. <br  />
✅ 2. If <code>interr_en</code> equals <code>true</code> call function <code><a class="el" href="port__system_8h.html#a0db5ab1cfb0707984ad278b002fcf7fc" title="Enable interrupts of a GPIO line (pin)">port_system_gpio_exti_enable()</a></code>, otherwise call function <code><a class="el" href="port__system_8h.html#a57047fe83ed119973a2ee0891e790459" title="Disable interrupts of a GPIO line (pin)">port_system_gpio_exti_disable()</a></code>. <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rx_id</td><td>Receiver ID. This index is used to select the element of the <code>receivers_arr[]</code> array. </td></tr>
    <tr><td class="paramname">interr_en</td><td>Argument to indicate if we want to enable or disable the interruptions of the infrared receiver. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afa467ec1901152155ceaaeb6862721b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa467ec1901152155ceaaeb6862721b1">&#9670;&nbsp;</a></span>port_rx_get_buffer_edges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t* port_rx_get_buffer_edges </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>rx_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a pointer to de memory address of the array that stores the time ticks of the edges detected by the infrared receiver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rx_id</td><td>Receiver ID. This index is used to select the element of the <code>receivers_arr[]</code> array. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint16_t Pointer to the memory address of the array of time ticks. </dd></dl>

</div>
</div>
<a id="aa84db03071cd8b41482846fbef7d92c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa84db03071cd8b41482846fbef7d92c0">&#9670;&nbsp;</a></span>port_rx_get_num_edges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t port_rx_get_num_edges </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>rx_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the number of edges detected by the infrared receiver so far. </p>
<blockquote class="doxtable">
<p><b>TO-DO alumnos:</b></p>
<p>✅ 1. Return the index used to go thought the array of edges <code>edge_idx</code>. <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rx_id</td><td>Receiver ID. This index is used to select the element of the <code>receivers_arr[]</code> array. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint32_t Number of edges detected so far. </dd></dl>

</div>
</div>
<a id="a5ef09693179985ae45e7ff87831701cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ef09693179985ae45e7ff87831701cf">&#9670;&nbsp;</a></span>port_rx_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void port_rx_init </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>rx_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure the HW specifications of a given infrared receiver. </p>
<blockquote class="doxtable">
<p><b>TO-DO alumnos:</b></p>
<p>✅ 1. Call function <code><a class="el" href="port__rx_8c.html#ada601d2748d08bea6f2e745dba307143" title="Configure the timer tick. This timer sets the basis for tick counting for checking received NEC symbo...">_timer_rx_setup()</a></code> to configure the timer of ticks in reception. This is the same timer for all the receivers in the system (if it exists more than one). <br  />
✅ 2. Call function <code><a class="el" href="port__system_8h.html#aedba1c00f3e11b81226406c03db75c14" title="Configure the mode and pull of a GPIO.">port_system_gpio_config()</a></code> with the right arguments to configure the infrared receiver GPIO to act as input, and no pull up neither pull down connection. <br  />
✅ 3. Call function <code><a class="el" href="port__system_8h.html#aaaa8d7afcf0ca35642667612a2dc0b27" title="Configure the external interruption or event of a GPIO.">port_system_gpio_config_exti()</a></code> with the right arguments to configure interruption mode in both rising and falling edges, and enable the interrupt request. <br  />
✅ 4. Call function <code><a class="el" href="port__system_8h.html#a0db5ab1cfb0707984ad278b002fcf7fc" title="Enable interrupts of a GPIO line (pin)">port_system_gpio_exti_enable()</a></code> with the right parameters to enable the interrupt line and set the priority level to <code>2</code> and the subpriority level to <code>0</code>. <br  />
✅ 5. Call function <code><a class="el" href="port__rx_8c.html#adfc4d3d8a0fc4e918aca2a1b26888642" title="Set the elements of the array of time ticks to &#39;0&#39; and init the index to &#39;0&#39; as well.">_reset_edge_ticks_idx()</a></code> to init some internal variables. <br  />
</p>
</blockquote>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rx_id</td><td>Receiver ID. This index is used to select the element of the <code>receivers_arr[]</code> array. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8b075d6927a2417e0e8f77f07fd5d7f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b075d6927a2417e0e8f77f07fd5d7f0">&#9670;&nbsp;</a></span>port_rx_tmr_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void port_rx_tmr_start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enable the tick count timer. </p>
<blockquote class="doxtable">
<p><b>TO-DO alumnos:</b></p>
<p>✅ 1. Reset the counter register (<code>CNT</code>) of our timer <code>TIM3</code>. <br  />
✅ 2. Enable the counter (register <code>CR1</code>). <br  />
</p>
</blockquote>

</div>
</div>
<a id="a528b7d08de033a1a60b6a191dcaf6d92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a528b7d08de033a1a60b6a191dcaf6d92">&#9670;&nbsp;</a></span>port_rx_tmr_stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void port_rx_tmr_stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disable the tick count timer. </p>
<blockquote class="doxtable">
<p><b>TO-DO alumnos:</b></p>
<p>✅ 1. Disable the counter (register <code>CR1</code>). <br  />
</p>
</blockquote>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_651562d8bf6cfd3e81eff5b570d7df50.html">port</a></li><li class="navelem"><a class="el" href="dir_8e468211b3f447a9458e01c9af4a2f29.html">nucleo_stm32f446re</a></li><li class="navelem"><a class="el" href="dir_8bd554dd5b9c116a11aefb4ea37bcfa2.html">src</a></li><li class="navelem"><a class="el" href="port__rx_8c.html">port_rx.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
